
-- DROP TABLE

/*
DROP TABLE T_SSC_USUARIO    CASCADE CONSTRAINTS;
DROP TABLE T_SSC_RESERVA    CASCADE CONSTRAINTS;
DROP TABLE T_SSC_DESPESA    CASCADE CONSTRAINTS;
DROP TABLE T_SSC_RECEITA    CASCADE CONSTRAINTS;
DROP TABLE T_SSC_FREQUENCIA CASCADE CONSTRAINTS;
*/

--

-- DROP SEQUENCE

/*
DROP SEQUENCE SQ_CD_USUARIO;
DROP SEQUENCE SQ_CD_DESPESA;
DROP SEQUENCE SQ_CD_RECEITA;
DROP SEQUENCE SQ_CD_RESERVA;
*/

--

-- T_SSC_USUARIO

CREATE TABLE T_SSC_USUARIO (
    cd_usuario NUMBER(8)     NOT NULL,
    ds_email   VARCHAR2(120) NOT NULL,
    nm_usuario VARCHAR2(30)  NOT NULL,
    ds_senha   VARCHAR2(60)  NOT NULL
);

ALTER TABLE T_SSC_USUARIO ADD CONSTRAINT PK_SSC_USUARIO PRIMARY KEY ( cd_usuario ); 

ALTER TABLE T_SSC_USUARIO ADD CONSTRAINT UN_USUARIO_EMAIL UNIQUE ( ds_email ); 

--

-- T_SSC_RESERVA

CREATE TABLE T_SSC_RESERVA (
    cd_reserva  NUMBER(9)     NOT NULL,
    cd_usuario  NUMBER(8)     NOT NULL,
    ds_reserva  VARCHAR2(60)  NOT NULL,
    vl_reserva  NUMBER(14, 2) NOT NULL,
    vl_meta     NUMBER(14, 2) NOT NULL,
    ds_objetivo VARCHAR2(120) NOT NULL
);

ALTER TABLE T_SSC_RESERVA ADD CONSTRAINT CK_RESERVA_VALOR CHECK ( vl_reserva >= 0 ); 

ALTER TABLE T_SSC_RESERVA ADD CONSTRAINT CK_RESERVA_META CHECK ( vl_meta >= 0 );

ALTER TABLE T_SSC_RESERVA ADD CONSTRAINT PK_SSC_RESERVA PRIMARY KEY ( cd_reserva ); 

--

-- T_SSC_DESPESA

CREATE TABLE T_SSC_DESPESA (
    cd_despesa    NUMBER(9)     NOT NULL,
    cd_usuario    NUMBER(8)     NOT NULL,
    cd_frequencia NUMBER(1)     NOT NULL,
    ds_despesa    VARCHAR2(60)  NOT NULL,
    vl_despesa    NUMBER(14, 2) NOT NULL,
    dt_despesa    DATE          NOT NULL
);

ALTER TABLE T_SSC_DESPESA ADD CONSTRAINT CK_DESPESA_VALOR CHECK ( vl_despesa >= 0 ); 

ALTER TABLE T_SSC_DESPESA ADD CONSTRAINT PK_SSC_DESPESA PRIMARY KEY ( cd_despesa ); 

--

-- T_SSC_RECEITA

CREATE TABLE T_SSC_RECEITA (
    cd_receita    NUMBER(9)     NOT NULL,
    cd_usuario    NUMBER(8)     NOT NULL,
    cd_frequencia NUMBER(1)     NOT NULL,
    ds_receita    VARCHAR2(60)  NOT NULL,
    vl_receita    NUMBER(14, 2) NOT NULL,
    dt_receita    DATE          NOT NULL
);

ALTER TABLE T_SSC_RECEITA ADD CONSTRAINT CK_RECEITA_VALOR CHECK ( vl_receita >= 0 ); 

ALTER TABLE T_SSC_RECEITA ADD CONSTRAINT PK_SSC_RECEITA PRIMARY KEY ( cd_receita ); 

-- 

-- T_SSC_FREQUENCIA

CREATE TABLE T_SSC_FREQUENCIA (
    cd_frequencia NUMBER(1)    NOT NULL,
    ds_frequencia VARCHAR2(10) NOT NULL
);

ALTER TABLE T_SSC_FREQUENCIA ADD CONSTRAINT PK_SSC_FREQUENCIA PRIMARY KEY ( cd_frequencia );

-- 

-- Foreign Keys

ALTER TABLE T_SSC_DESPESA
    ADD CONSTRAINT FK_FREQUENCIA_DESPESA FOREIGN KEY ( cd_frequencia ) 
        REFERENCES T_SSC_FREQUENCIA ( cd_frequencia );

ALTER TABLE T_SSC_RECEITA
    ADD CONSTRAINT FK_FREQUENCIA_RECEITA FOREIGN KEY ( cd_frequencia )
        REFERENCES T_SSC_FREQUENCIA ( cd_frequencia );

ALTER TABLE T_SSC_DESPESA
    ADD CONSTRAINT FK_USUARIO_DESPESA FOREIGN KEY ( cd_usuario )
        REFERENCES T_SSC_USUARIO ( cd_usuario );

ALTER TABLE T_SSC_RECEITA
    ADD CONSTRAINT FK_USUARIO_RECEITA FOREIGN KEY ( cd_usuario )
        REFERENCES T_SSC_USUARIO ( cd_usuario );

ALTER TABLE T_SSC_RESERVA
    ADD CONSTRAINT FK_USUARIO_RESERVA FOREIGN KEY ( cd_usuario )
        REFERENCES T_SSC_USUARIO ( cd_usuario );

--

-- 	SEQUENCES

CREATE SEQUENCE SQ_CD_USUARIO
INCREMENT BY 1
START WITH 1
MAXVALUE 99999999
NOCACHE
NOCYCLE;

CREATE SEQUENCE SQ_CD_DESPESA
INCREMENT BY 1
START WITH 1
MAXVALUE 999999999
NOCACHE
NOCYCLE;

CREATE SEQUENCE SQ_CD_RECEITA
INCREMENT BY 1
START WITH 1
MAXVALUE 999999999
NOCACHE
NOCYCLE;

CREATE SEQUENCE SQ_CD_RESERVA
INCREMENT BY 1
START WITH 1
MAXVALUE 999999999
NOCACHE
NOCYCLE;

--

-- INSERT T_SSC_FREQUENCIA

Insert Into T_Ssc_Frequencia (Cd_Frequencia, Ds_Frequencia) Values (1 , 'Fixa');
Insert Into T_Ssc_Frequencia (Cd_Frequencia, Ds_Frequencia) Values (2 , 'Vari√°vel');